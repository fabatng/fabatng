{"id":"FhWA","dependencies":[{"name":"/home/caleb_deji/workspace/client-projects/mechanics/package.json","includedInParent":true,"mtime":1574302712481},{"name":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/package.json","includedInParent":true,"mtime":1574281567256},{"name":"assert-plus","loc":{"line":3,"column":21},"parent":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/verify.js","resolved":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/assert-plus/assert.js"},{"name":"crypto","loc":{"line":4,"column":21},"parent":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/verify.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/node_modules/crypto-browserify/index.js"},{"name":"sshpk","loc":{"line":5,"column":20},"parent":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/verify.js","resolved":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/sshpk/lib/index.js"},{"name":"./utils","loc":{"line":6,"column":20},"parent":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/verify.js","resolved":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/utils.js"},{"name":"buffer","parent":"/home/caleb_deji/workspace/client-projects/mechanics/node_modules/http-signature/lib/verify.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/node_modules/buffer/index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar r=require(\"buffer\").Buffer,e=require(\"assert-plus\"),t=require(\"crypto\"),a=require(\"sshpk\"),i=require(\"./utils\"),s=i.HASH_ALGOS,u=i.PK_ALGOS,n=i.InvalidAlgorithmError,g=i.HttpSignatureError,p=i.validateAlgorithm;module.exports={verifySignature:function(t,i){e.object(t,\"parsedSignature\"),(\"string\"==typeof i||r.isBuffer(i))&&(i=a.parseKey(i)),e.ok(a.Key.isKey(i,[1,1]),\"pubkey must be a sshpk.Key\");var s=p(t.algorithm);if(\"hmac\"===s[0]||s[0]!==i.type)return!1;var u=i.createVerify(s[1]);return u.update(t.signingString),u.verify(t.params.signature,\"base64\")},verifyHMAC:function(a,i){e.object(a,\"parsedHMAC\"),e.string(i,\"secret\");var s=p(a.algorithm);if(\"hmac\"!==s[0])return!1;var u=s[1].toUpperCase(),n=t.createHmac(u,i);n.update(a.signingString);var g=t.createHmac(u,i);g.update(n.digest()),g=g.digest();var o=t.createHmac(u,i);return o.update(new r(a.params.signature,\"base64\")),o=o.digest(),\"string\"==typeof g?g===o:r.isBuffer(g)&&!g.equals?g.toString(\"binary\")===o.toString(\"binary\"):g.equals(o)}};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":0},"generated":{"line":2,"column":4}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":0},"generated":{"line":2,"column":6}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":0},"generated":{"line":2,"column":14}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":0},"generated":{"line":2,"column":24}},{"source":"node_modules/http-signature/lib/verify.js","name":"assert","original":{"line":3,"column":4},"generated":{"line":2,"column":31}},{"source":"node_modules/http-signature/lib/verify.js","name":"require","original":{"line":3,"column":13},"generated":{"line":2,"column":33}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":3,"column":21},"generated":{"line":2,"column":41}},{"source":"node_modules/http-signature/lib/verify.js","name":"crypto","original":{"line":4,"column":4},"generated":{"line":2,"column":56}},{"source":"node_modules/http-signature/lib/verify.js","name":"require","original":{"line":4,"column":13},"generated":{"line":2,"column":58}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":4,"column":21},"generated":{"line":2,"column":66}},{"source":"node_modules/http-signature/lib/verify.js","name":"sshpk","original":{"line":5,"column":4},"generated":{"line":2,"column":76}},{"source":"node_modules/http-signature/lib/verify.js","name":"require","original":{"line":5,"column":12},"generated":{"line":2,"column":78}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":5,"column":20},"generated":{"line":2,"column":86}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":6,"column":4},"generated":{"line":2,"column":95}},{"source":"node_modules/http-signature/lib/verify.js","name":"require","original":{"line":6,"column":12},"generated":{"line":2,"column":97}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":6,"column":20},"generated":{"line":2,"column":105}},{"source":"node_modules/http-signature/lib/verify.js","name":"HASH_ALGOS","original":{"line":8,"column":4},"generated":{"line":2,"column":116}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":8,"column":17},"generated":{"line":2,"column":118}},{"source":"node_modules/http-signature/lib/verify.js","name":"HASH_ALGOS","original":{"line":8,"column":23},"generated":{"line":2,"column":120}},{"source":"node_modules/http-signature/lib/verify.js","name":"PK_ALGOS","original":{"line":9,"column":4},"generated":{"line":2,"column":131}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":9,"column":15},"generated":{"line":2,"column":133}},{"source":"node_modules/http-signature/lib/verify.js","name":"PK_ALGOS","original":{"line":9,"column":21},"generated":{"line":2,"column":135}},{"source":"node_modules/http-signature/lib/verify.js","name":"InvalidAlgorithmError","original":{"line":10,"column":4},"generated":{"line":2,"column":144}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":10,"column":28},"generated":{"line":2,"column":146}},{"source":"node_modules/http-signature/lib/verify.js","name":"InvalidAlgorithmError","original":{"line":10,"column":34},"generated":{"line":2,"column":148}},{"source":"node_modules/http-signature/lib/verify.js","name":"HttpSignatureError","original":{"line":11,"column":4},"generated":{"line":2,"column":170}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":11,"column":25},"generated":{"line":2,"column":172}},{"source":"node_modules/http-signature/lib/verify.js","name":"HttpSignatureError","original":{"line":11,"column":31},"generated":{"line":2,"column":174}},{"source":"node_modules/http-signature/lib/verify.js","name":"validateAlgorithm","original":{"line":12,"column":4},"generated":{"line":2,"column":193}},{"source":"node_modules/http-signature/lib/verify.js","name":"utils","original":{"line":12,"column":24},"generated":{"line":2,"column":195}},{"source":"node_modules/http-signature/lib/verify.js","name":"validateAlgorithm","original":{"line":12,"column":30},"generated":{"line":2,"column":197}},{"source":"node_modules/http-signature/lib/verify.js","name":"module","original":{"line":16,"column":0},"generated":{"line":2,"column":215}},{"source":"node_modules/http-signature/lib/verify.js","name":"exports","original":{"line":16,"column":7},"generated":{"line":2,"column":222}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":16,"column":17},"generated":{"line":2,"column":230}},{"source":"node_modules/http-signature/lib/verify.js","name":"verifySignature","original":{"line":27,"column":2},"generated":{"line":2,"column":231}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":27,"column":19},"generated":{"line":2,"column":247}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":27,"column":44},"generated":{"line":2,"column":256}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":27,"column":61},"generated":{"line":2,"column":258}},{"source":"node_modules/http-signature/lib/verify.js","name":"assert","original":{"line":28,"column":4},"generated":{"line":2,"column":261}},{"source":"node_modules/http-signature/lib/verify.js","name":"object","original":{"line":28,"column":11},"generated":{"line":2,"column":263}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":28,"column":18},"generated":{"line":2,"column":270}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":28,"column":35},"generated":{"line":2,"column":272}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":29,"column":28},"generated":{"line":2,"column":292}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":29,"column":16},"generated":{"line":2,"column":309}},{"source":"node_modules/http-signature/lib/verify.js","name":"Buffer","original":{"line":29,"column":40},"generated":{"line":2,"column":312}},{"source":"node_modules/http-signature/lib/verify.js","name":"isBuffer","original":{"line":29,"column":47},"generated":{"line":2,"column":314}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":29,"column":56},"generated":{"line":2,"column":323}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":30,"column":6},"generated":{"line":2,"column":329}},{"source":"node_modules/http-signature/lib/verify.js","name":"sshpk","original":{"line":30,"column":15},"generated":{"line":2,"column":331}},{"source":"node_modules/http-signature/lib/verify.js","name":"parseKey","original":{"line":30,"column":21},"generated":{"line":2,"column":333}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":30,"column":30},"generated":{"line":2,"column":342}},{"source":"node_modules/http-signature/lib/verify.js","name":"assert","original":{"line":31,"column":4},"generated":{"line":2,"column":346}},{"source":"node_modules/http-signature/lib/verify.js","name":"ok","original":{"line":31,"column":11},"generated":{"line":2,"column":348}},{"source":"node_modules/http-signature/lib/verify.js","name":"sshpk","original":{"line":31,"column":14},"generated":{"line":2,"column":351}},{"source":"node_modules/http-signature/lib/verify.js","name":"Key","original":{"line":31,"column":20},"generated":{"line":2,"column":353}},{"source":"node_modules/http-signature/lib/verify.js","name":"isKey","original":{"line":31,"column":24},"generated":{"line":2,"column":357}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":31,"column":30},"generated":{"line":2,"column":363}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":31,"column":38},"generated":{"line":2,"column":365}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":31,"column":39},"generated":{"line":2,"column":366}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":31,"column":42},"generated":{"line":2,"column":368}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":31,"column":47},"generated":{"line":2,"column":372}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":33,"column":8},"generated":{"line":2,"column":402}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":33,"column":8},"generated":{"line":2,"column":406}},{"source":"node_modules/http-signature/lib/verify.js","name":"validateAlgorithm","original":{"line":33,"column":14},"generated":{"line":2,"column":408}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":33,"column":32},"generated":{"line":2,"column":410}},{"source":"node_modules/http-signature/lib/verify.js","name":"algorithm","original":{"line":33,"column":48},"generated":{"line":2,"column":412}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":34,"column":8},"generated":{"line":2,"column":423}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":34,"column":19},"generated":{"line":2,"column":426}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":34,"column":8},"generated":{"line":2,"column":435}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":34,"column":12},"generated":{"line":2,"column":437}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":34,"column":29},"generated":{"line":2,"column":441}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":34,"column":33},"generated":{"line":2,"column":443}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":34,"column":40},"generated":{"line":2,"column":448}},{"source":"node_modules/http-signature/lib/verify.js","name":"type","original":{"line":34,"column":47},"generated":{"line":2,"column":450}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":35,"column":6},"generated":{"line":2,"column":455}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":35,"column":14},"generated":{"line":2,"column":462}},{"source":"node_modules/http-signature/lib/verify.js","name":"v","original":{"line":37,"column":8},"generated":{"line":2,"column":464}},{"source":"node_modules/http-signature/lib/verify.js","name":"v","original":{"line":37,"column":8},"generated":{"line":2,"column":468}},{"source":"node_modules/http-signature/lib/verify.js","name":"pubkey","original":{"line":37,"column":12},"generated":{"line":2,"column":470}},{"source":"node_modules/http-signature/lib/verify.js","name":"createVerify","original":{"line":37,"column":19},"generated":{"line":2,"column":472}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":37,"column":32},"generated":{"line":2,"column":485}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":37,"column":36},"generated":{"line":2,"column":487}},{"source":"node_modules/http-signature/lib/verify.js","name":"v","original":{"line":39,"column":12},"generated":{"line":2,"column":491}},{"source":"node_modules/http-signature/lib/verify.js","name":"v","original":{"line":38,"column":4},"generated":{"line":2,"column":498}},{"source":"node_modules/http-signature/lib/verify.js","name":"update","original":{"line":38,"column":6},"generated":{"line":2,"column":500}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":38,"column":13},"generated":{"line":2,"column":507}},{"source":"node_modules/http-signature/lib/verify.js","name":"signingString","original":{"line":38,"column":29},"generated":{"line":2,"column":509}},{"source":"node_modules/http-signature/lib/verify.js","name":"v","original":{"line":39,"column":12},"generated":{"line":2,"column":524}},{"source":"node_modules/http-signature/lib/verify.js","name":"verify","original":{"line":39,"column":14},"generated":{"line":2,"column":526}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":39,"column":21},"generated":{"line":2,"column":533}},{"source":"node_modules/http-signature/lib/verify.js","name":"params","original":{"line":39,"column":37},"generated":{"line":2,"column":535}},{"source":"node_modules/http-signature/lib/verify.js","name":"signature","original":{"line":39,"column":44},"generated":{"line":2,"column":542}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":39,"column":55},"generated":{"line":2,"column":552}},{"source":"node_modules/http-signature/lib/verify.js","name":"verifyHMAC","original":{"line":52,"column":2},"generated":{"line":2,"column":563}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":52,"column":14},"generated":{"line":2,"column":574}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":52,"column":34},"generated":{"line":2,"column":583}},{"source":"node_modules/http-signature/lib/verify.js","name":"secret","original":{"line":52,"column":51},"generated":{"line":2,"column":585}},{"source":"node_modules/http-signature/lib/verify.js","name":"assert","original":{"line":53,"column":4},"generated":{"line":2,"column":588}},{"source":"node_modules/http-signature/lib/verify.js","name":"object","original":{"line":53,"column":11},"generated":{"line":2,"column":590}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":53,"column":18},"generated":{"line":2,"column":597}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":53,"column":35},"generated":{"line":2,"column":599}},{"source":"node_modules/http-signature/lib/verify.js","name":"assert","original":{"line":54,"column":4},"generated":{"line":2,"column":613}},{"source":"node_modules/http-signature/lib/verify.js","name":"string","original":{"line":54,"column":11},"generated":{"line":2,"column":615}},{"source":"node_modules/http-signature/lib/verify.js","name":"secret","original":{"line":54,"column":18},"generated":{"line":2,"column":622}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":54,"column":26},"generated":{"line":2,"column":624}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":56,"column":8},"generated":{"line":2,"column":634}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":56,"column":8},"generated":{"line":2,"column":638}},{"source":"node_modules/http-signature/lib/verify.js","name":"validateAlgorithm","original":{"line":56,"column":14},"generated":{"line":2,"column":640}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":56,"column":32},"generated":{"line":2,"column":642}},{"source":"node_modules/http-signature/lib/verify.js","name":"algorithm","original":{"line":56,"column":48},"generated":{"line":2,"column":644}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":57,"column":8},"generated":{"line":2,"column":655}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":57,"column":19},"generated":{"line":2,"column":658}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":57,"column":8},"generated":{"line":2,"column":667}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":57,"column":12},"generated":{"line":2,"column":669}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":58,"column":6},"generated":{"line":2,"column":672}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":58,"column":14},"generated":{"line":2,"column":679}},{"source":"node_modules/http-signature/lib/verify.js","name":"hashAlg","original":{"line":60,"column":8},"generated":{"line":2,"column":681}},{"source":"node_modules/http-signature/lib/verify.js","name":"hashAlg","original":{"line":60,"column":8},"generated":{"line":2,"column":685}},{"source":"node_modules/http-signature/lib/verify.js","name":"alg","original":{"line":60,"column":18},"generated":{"line":2,"column":687}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":60,"column":22},"generated":{"line":2,"column":689}},{"source":"node_modules/http-signature/lib/verify.js","name":"toUpperCase","original":{"line":60,"column":25},"generated":{"line":2,"column":692}},{"source":"node_modules/http-signature/lib/verify.js","name":"hmac","original":{"line":62,"column":8},"generated":{"line":2,"column":706}},{"source":"node_modules/http-signature/lib/verify.js","name":"crypto","original":{"line":62,"column":15},"generated":{"line":2,"column":708}},{"source":"node_modules/http-signature/lib/verify.js","name":"createHmac","original":{"line":62,"column":22},"generated":{"line":2,"column":710}},{"source":"node_modules/http-signature/lib/verify.js","name":"hashAlg","original":{"line":62,"column":33},"generated":{"line":2,"column":721}},{"source":"node_modules/http-signature/lib/verify.js","name":"secret","original":{"line":62,"column":42},"generated":{"line":2,"column":723}},{"source":"node_modules/http-signature/lib/verify.js","name":"hmac","original":{"line":63,"column":4},"generated":{"line":2,"column":726}},{"source":"node_modules/http-signature/lib/verify.js","name":"update","original":{"line":63,"column":9},"generated":{"line":2,"column":728}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":63,"column":16},"generated":{"line":2,"column":735}},{"source":"node_modules/http-signature/lib/verify.js","name":"signingString","original":{"line":63,"column":32},"generated":{"line":2,"column":737}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":72,"column":8},"generated":{"line":2,"column":752}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":72,"column":8},"generated":{"line":2,"column":756}},{"source":"node_modules/http-signature/lib/verify.js","name":"crypto","original":{"line":72,"column":13},"generated":{"line":2,"column":758}},{"source":"node_modules/http-signature/lib/verify.js","name":"createHmac","original":{"line":72,"column":20},"generated":{"line":2,"column":760}},{"source":"node_modules/http-signature/lib/verify.js","name":"hashAlg","original":{"line":72,"column":31},"generated":{"line":2,"column":771}},{"source":"node_modules/http-signature/lib/verify.js","name":"secret","original":{"line":72,"column":40},"generated":{"line":2,"column":773}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":73,"column":4},"generated":{"line":2,"column":776}},{"source":"node_modules/http-signature/lib/verify.js","name":"update","original":{"line":73,"column":7},"generated":{"line":2,"column":778}},{"source":"node_modules/http-signature/lib/verify.js","name":"hmac","original":{"line":73,"column":14},"generated":{"line":2,"column":785}},{"source":"node_modules/http-signature/lib/verify.js","name":"digest","original":{"line":73,"column":19},"generated":{"line":2,"column":787}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":74,"column":4},"generated":{"line":2,"column":797}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":74,"column":9},"generated":{"line":2,"column":799}},{"source":"node_modules/http-signature/lib/verify.js","name":"digest","original":{"line":74,"column":12},"generated":{"line":2,"column":801}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":75,"column":8},"generated":{"line":2,"column":810}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":75,"column":8},"generated":{"line":2,"column":814}},{"source":"node_modules/http-signature/lib/verify.js","name":"crypto","original":{"line":75,"column":13},"generated":{"line":2,"column":816}},{"source":"node_modules/http-signature/lib/verify.js","name":"createHmac","original":{"line":75,"column":20},"generated":{"line":2,"column":818}},{"source":"node_modules/http-signature/lib/verify.js","name":"hashAlg","original":{"line":75,"column":31},"generated":{"line":2,"column":829}},{"source":"node_modules/http-signature/lib/verify.js","name":"secret","original":{"line":75,"column":40},"generated":{"line":2,"column":831}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":80,"column":8},"generated":{"line":2,"column":834}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":76,"column":4},"generated":{"line":2,"column":841}},{"source":"node_modules/http-signature/lib/verify.js","name":"update","original":{"line":76,"column":7},"generated":{"line":2,"column":843}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":76,"column":14},"generated":{"line":2,"column":850}},{"source":"node_modules/http-signature/lib/verify.js","name":"Buffer","original":{"line":76,"column":18},"generated":{"line":2,"column":854}},{"source":"node_modules/http-signature/lib/verify.js","name":"parsedSignature","original":{"line":76,"column":25},"generated":{"line":2,"column":856}},{"source":"node_modules/http-signature/lib/verify.js","name":"params","original":{"line":76,"column":41},"generated":{"line":2,"column":858}},{"source":"node_modules/http-signature/lib/verify.js","name":"signature","original":{"line":76,"column":48},"generated":{"line":2,"column":865}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":76,"column":59},"generated":{"line":2,"column":875}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":77,"column":4},"generated":{"line":2,"column":886}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":77,"column":9},"generated":{"line":2,"column":888}},{"source":"node_modules/http-signature/lib/verify.js","name":"digest","original":{"line":77,"column":12},"generated":{"line":2,"column":890}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":80,"column":24},"generated":{"line":2,"column":899}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":80,"column":16},"generated":{"line":2,"column":916}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":81,"column":14},"generated":{"line":2,"column":918}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":81,"column":21},"generated":{"line":2,"column":922}},{"source":"node_modules/http-signature/lib/verify.js","name":"Buffer","original":{"line":83,"column":8},"generated":{"line":2,"column":924}},{"source":"node_modules/http-signature/lib/verify.js","name":"isBuffer","original":{"line":83,"column":15},"generated":{"line":2,"column":926}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":83,"column":24},"generated":{"line":2,"column":935}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":83,"column":32},"generated":{"line":2,"column":940}},{"source":"node_modules/http-signature/lib/verify.js","name":"equals","original":{"line":83,"column":35},"generated":{"line":2,"column":942}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":84,"column":14},"generated":{"line":2,"column":949}},{"source":"node_modules/http-signature/lib/verify.js","name":"toString","original":{"line":84,"column":17},"generated":{"line":2,"column":951}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":84,"column":26},"generated":{"line":2,"column":960}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":84,"column":40},"generated":{"line":2,"column":972}},{"source":"node_modules/http-signature/lib/verify.js","name":"toString","original":{"line":84,"column":43},"generated":{"line":2,"column":974}},{"source":"node_modules/http-signature/lib/verify.js","original":{"line":84,"column":52},"generated":{"line":2,"column":983}},{"source":"node_modules/http-signature/lib/verify.js","name":"h1","original":{"line":86,"column":12},"generated":{"line":2,"column":993}},{"source":"node_modules/http-signature/lib/verify.js","name":"equals","original":{"line":86,"column":15},"generated":{"line":2,"column":995}},{"source":"node_modules/http-signature/lib/verify.js","name":"h2","original":{"line":86,"column":22},"generated":{"line":2,"column":1002}}],"sources":{"node_modules/http-signature/lib/verify.js":"// Copyright 2015 Joyent, Inc.\n\nvar assert = require('assert-plus');\nvar crypto = require('crypto');\nvar sshpk = require('sshpk');\nvar utils = require('./utils');\n\nvar HASH_ALGOS = utils.HASH_ALGOS;\nvar PK_ALGOS = utils.PK_ALGOS;\nvar InvalidAlgorithmError = utils.InvalidAlgorithmError;\nvar HttpSignatureError = utils.HttpSignatureError;\nvar validateAlgorithm = utils.validateAlgorithm;\n\n///--- Exported API\n\nmodule.exports = {\n  /**\n   * Verify RSA/DSA signature against public key.  You are expected to pass in\n   * an object that was returned from `parse()`.\n   *\n   * @param {Object} parsedSignature the object you got from `parse`.\n   * @param {String} pubkey RSA/DSA private key PEM.\n   * @return {Boolean} true if valid, false otherwise.\n   * @throws {TypeError} if you pass in bad arguments.\n   * @throws {InvalidAlgorithmError}\n   */\n  verifySignature: function verifySignature(parsedSignature, pubkey) {\n    assert.object(parsedSignature, 'parsedSignature');\n    if (typeof (pubkey) === 'string' || Buffer.isBuffer(pubkey))\n      pubkey = sshpk.parseKey(pubkey);\n    assert.ok(sshpk.Key.isKey(pubkey, [1, 1]), 'pubkey must be a sshpk.Key');\n\n    var alg = validateAlgorithm(parsedSignature.algorithm);\n    if (alg[0] === 'hmac' || alg[0] !== pubkey.type)\n      return (false);\n\n    var v = pubkey.createVerify(alg[1]);\n    v.update(parsedSignature.signingString);\n    return (v.verify(parsedSignature.params.signature, 'base64'));\n  },\n\n  /**\n   * Verify HMAC against shared secret.  You are expected to pass in an object\n   * that was returned from `parse()`.\n   *\n   * @param {Object} parsedSignature the object you got from `parse`.\n   * @param {String} secret HMAC shared secret.\n   * @return {Boolean} true if valid, false otherwise.\n   * @throws {TypeError} if you pass in bad arguments.\n   * @throws {InvalidAlgorithmError}\n   */\n  verifyHMAC: function verifyHMAC(parsedSignature, secret) {\n    assert.object(parsedSignature, 'parsedHMAC');\n    assert.string(secret, 'secret');\n\n    var alg = validateAlgorithm(parsedSignature.algorithm);\n    if (alg[0] !== 'hmac')\n      return (false);\n\n    var hashAlg = alg[1].toUpperCase();\n\n    var hmac = crypto.createHmac(hashAlg, secret);\n    hmac.update(parsedSignature.signingString);\n\n    /*\n     * Now double-hash to avoid leaking timing information - there's\n     * no easy constant-time compare in JS, so we use this approach\n     * instead. See for more info:\n     * https://www.isecpartners.com/blog/2011/february/double-hmac-\n     * verification.aspx\n     */\n    var h1 = crypto.createHmac(hashAlg, secret);\n    h1.update(hmac.digest());\n    h1 = h1.digest();\n    var h2 = crypto.createHmac(hashAlg, secret);\n    h2.update(new Buffer(parsedSignature.params.signature, 'base64'));\n    h2 = h2.digest();\n\n    /* Node 0.8 returns strings from .digest(). */\n    if (typeof (h1) === 'string')\n      return (h1 === h2);\n    /* And node 0.10 lacks the .equals() method on Buffers. */\n    if (Buffer.isBuffer(h1) && !h1.equals)\n      return (h1.toString('binary') === h2.toString('binary'));\n\n    return (h1.equals(h2));\n  }\n};\n"},"lineCount":null}},"error":null,"hash":"d6de7c492d8afe61206033e898d00ec5","cacheData":{"env":{}}}